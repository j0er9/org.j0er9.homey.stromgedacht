<script type="text/javascript">
    Homey.setTitle(Homey.__('pair.validate_plz.title'));

    function doSubmit(){
        let zip = document.getElementById('zip').value.trim();

        if(!zip){
            Homey.alert(Homey.__('pair.validate_plz.error_empty'));
        }
        else {
            Homey.emit('validate_plz', { zip })
                .then(result => {
                    if (result.valid) {
                        Homey.nextView();
                    } else {
                        Homey.alert(Homey.__('pair.validate_plz.error_invalid'));
                    }
                })
                .catch(error => {
                    Homey.alert(error);
                });
        }
    }

</script>

<form class="homey-form">
    <div class="homey-form-group">
        <label class="homey-form-label" for="zip" id="zip-label"></label>
        <input class="homey-form-input" type="text" id="zip" name="zipcode" required />
    </div>

    <button type="button" class="homey-button-primary" onclick="doSubmit()" id="save-button"></button>
</form>

<script type="text/javascript">
    // Set translatable content after DOM is loaded
    document.getElementById('zip-label').textContent = Homey.__('pair.validate_plz.zip_label');
    document.getElementById('zip').placeholder = Homey.__('pair.validate_plz.zip_placeholder');
    document.getElementById('save-button').textContent = Homey.__('pair.validate_plz.button_save');
</script>